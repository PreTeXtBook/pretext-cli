// This file was automatically generated with PreTeXt 2.15.2.
// If you modify this file, PreTeXt will no longer automatically update it.
//
//////////////////////////////////////////////////////////////
//
// This file provides configuration options so that a PreTeXt
//   project can be edited and built using GitHub's Codespaces.
// It is recommended to keep this in your repository even if you
//   do not use this feature, as it will allow other to explore
//   your project easily.
// This file will be automatically generated by PreTeXt with the
//   latest updates unless you remove the first comment line above.
//
///////////////////////////////////////////////////////////////
{
  "name": "PreTeXt-Codespaces",

  // The default docker image has just pretext and prefigure installed.  No LaTeX and no SageMath.  Those can be installed using scripts or by switching to one of the larger images below.:
   "image": "oscarlevin/pretext:lite",

  // This Docker image includes some LaTeX support, but is still not to large.  Note that if you keep your codespace running, it will use up your GitHub free storage quota.  
  // "image": "oscarlevin/pretext:small",

   // If you need to generate sageplots, comment out the above line and uncomment the following line.
  //"image": "oscarlevin/pretext:full",


  // Add gh cli as a feature (to support codechat)
  "features": {
    "ghcr.io/devcontainers/features/github-cli:1": {}
  },

  // Respect the project's designated dependencies
  "postCreateCommand": "git config --global --add safe.directory $(pwd) && pip install -r requirements.txt",

  // If you need LaTeX support (to build pdfs or to generate latex-images), you can uncomment the next line (and comment out the "postCreateCommand" above.)
  // "postCreateCommand": "git config --global --add safe.directory $(pwd) && bash ./.github/scripts/add-latex.sh",

  // If you need sageplot support, instead of installing the pretext:full image above, you can uncomment the line below and comment out the line above.
  // "postCreateCommand": "git config --global --add safe.directory $(pwd) && bash ./.github/scripts/add-sage.sh",

  // For both LaTeX and sageplot support, use this "postCreateCommand":
  // "postCreateCommand": "git config --global --add safe.directory $(pwd) && bash ./.github/scripts/add-latex.sh && bash ./.github/scripts/add-sage.sh",


  // Port forwarding
  // ---------------
  // This is needed by the CodeChat Server.
  "forwardPorts": [
    // The port used for a Thrift connection between the VSCode CodeChat
    // extension and the CodeChat Server.
    27376,
    // The port used for an HTTP connection from the CodeChat Client to
    // the CodeChat Server.
    27377,
    // The port used by a websocket connection between the CodeChat
    // Server and the CodeChat Client.
    27378
  ],
  // See the [docs](https://containers.dev/implementors/json_reference/#port-attributes).
  "portsAttributes": {
    "27376": {
      "label": "VSCode extension <-> CodeChat Server",
      "requireLocalPort": true
    },
    "27377": {
      "label": "CodeChat Client",
      "requireLocalPort": true
    },
    "27378": {
      "label": "CodeChat Client<->Server websocket",
      "requireLocalPort": true
      // This port needs to be public; however, there's no way to specify port visibility here. See `server.py` in the CodeChat Server for details.
    }
  },

  // Configure tool-specific properties.
  "customizations": {
    "codespaces": {
      "openFiles": ["source/main.ptx"]
    },
    "vscode": {
      "settings": {
        "editor.quickSuggestions": {
          "other": "off"
        },
        "editor.snippetSuggestions": "top",
        "xml.validation.enabled": false,
        "CodeChat.CodeChatServer.Command": "CodeChat_Server"
      },
      "extensions": [
        "ms-vscode.live-server",
        "oscarlevin.pretext-tools",
        "CodeChat.codechat"
      ]
    }
  }

  // Uncomment to connect as root instead. More info: https://aka.ms/dev-containers-non-root.
  // "remoteUser": "root"
}
